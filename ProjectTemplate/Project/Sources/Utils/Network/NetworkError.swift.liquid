//
//  NetworkError.swift
//  {{ module_info.name }}
//
//  Created by {{ developer.name }} on {{ date }}.
//  Copyright {{ year }} {{ developer.company }}. All rights reserved.

import Foundation
import SwiftyJSON

class NetworkError: Error {

    let code: String
    let message: String
    let json: JSON?

    var isCanceled: Bool {
        code == .canceledError
    }

    init(code: String, message: String, json: JSON? = nil) {
        self.code = code
        self.message = message
        self.json = json
    }

    init?(withJson json: JSON) {
        guard let code = json["code"].string,
              let message = json["message"].string else { return nil }

        self.code = code
        self.message = message
        self.json = json
    }
}

extension NetworkError: Equatable {
    
    static func == (lhs: NetworkError, rhs: NetworkError) -> Bool {
        lhs.code == rhs.code &&
            lhs.json == rhs.json
    }
}

extension NetworkError {

    static let noNetworkConnectionError = NetworkError(
        code: .noNetworkConnection,
        message: R.string.network.noNetworkConnection()
    )

    static let slowNetworkConnectionError = NetworkError(
        code: .slowNetworkConnection,
        message: R.string.network.slowNetworkConnection()
    )

    static let unrecognizedResponse = NetworkError(
        code: .unrecognizedResponse,
        message: R.string.network.unrecognizedResponse()
    )

    static let unrecognizedError = NetworkError(
        code: .unrecognizedError,
        message: R.string.network.unrecognizedError()
    )

    static let canceledError = NetworkError(
        code: .canceledError,
        message: ""
    )
}
