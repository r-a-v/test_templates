//
//  Token.swift
//  {{ module_info.name }}
//
//  Created by {{ developer.name }} on {{ date }}.
//  Copyright {{ year }} {{ developer.company }}. All rights reserved.
//

import Foundation
import SwiftyJSON

// MARK: - Token
final class Token: Codable {

// MARK: - Properties
    private(set) var value: String
    private(set) var expiresAt: Date

    var isValid: Bool {
        Date() < self.expiresAt.addingTimeInterval(-60)
    }

// MARK: - Init
    init?(withJson json: JSON) {
        guard let value = json["value"].string,
              let expiresAtTimestamp = json["expires_at"].int else { return nil }

        self.value = value
        self.expiresAt = Date(timeIntervalSince1970: TimeInterval(expiresAtTimestamp))
    }

}